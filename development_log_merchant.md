# 가맹점 관리 페이지(Merchant Page) 개발일지

## 1. 개요 (Overview)

가맹점 관리 페이지는 시스템에 등록된 모든 가맹점의 목록을 표시하고, 관리자가 이를 쉽게 조회, 검색 및 관리(수정/삭제)할 수 있도록 하는 기능입니다. 이 페이지는 재사용 가능한 컴포넌트 기반으로 설계되어 유지보수성과 확장성을 높이는 데 중점을 두었습니다.

---

## 2. 페이지 주요 로직 (`/src/app/(admin)/merchant/page.tsx`)

페이지의 핵심 로직은 데이터를 불러와 상태로 관리하고, 이를 UI에 렌더링하는 것입니다.

### 데이터 관리 (State Management)

-   `useState` React Hook을 사용하여 컴포넌트의 상태를 관리합니다.
    -   `merchants`: API로부터 받아온 가맹점 목록 데이터를 저장하는 상태입니다. 이 상태가 변경되면 화면이 다시 렌더링됩니다.
    -   `loading`: 데이터 로딩 상태를 관리하는 boolean 값입니다. API 요청 시작 시 `true`가 되고, 완료되면 `false`가 되어 사용자에게 로딩 중임을 알려주는 역할을 합니다.

### API 통신 (Data Fetching)

-   `useEffect` Hook을 사용하여 페이지가 처음 렌더링될 때 가맹점 데이터를 불러옵니다.
    -   `fetchMerchants` 함수는 `http://localhost:8000/api/merchants` 엔드포인트에 `fetch` 요청을 보내 전체 가맹점 목록을 가져옵니다.
    -   데이터를 성공적으로 가져오면, `map` 함수를 통해 각 가맹점 데이터에 `id` 속성을 추가합니다. 이는 React가 목록을 렌더링할 때 각 항목을 고유하게 식별하기 위한 `key` 값으로 사용되며, 안정적인 렌더링을 보장합니다.
    -   데이터 로딩이 완료되면 `setLoading(false)`를 호출하여 로딩 상태를 해제합니다.

### UI 렌더링 (Rendering)

-   **조건부 렌더링**: `loading` 상태가 `true`일 동안은 "데이터를 불러오는 중입니다..." 메시지를 표시하여 사용자 경험을 향상시킵니다.
-   **컴포넌트 조합**: 로딩이 완료되면, `TableSearch`, `Table`, `Pagination` 등 미리 만들어진 재사용 컴포넌트들을 조합하여 전체 페이지 레이아웃을 구성합니다.

---

## 3. 사용된 주요 컴포넌트 및 관계

이 페이지는 여러 개의 재사용 가능한 컴포넌트로 구성되어 있으며, 각 컴포넌트는 명확한 역할을 담당합니다. 이는 "Container/Presentational" 디자인 패턴과 유사한 구조입니다.

### `Table` 컴포넌트

-   **설명**: 데이터를 테이블 형태로 표시하는 범용 컴포넌트입니다. 테이블의 구조(뼈대)만 제공하며, 내용과 스타일은 `props`를 통해 주입받습니다.
-   **관계**: `merchant` 페이지는 `Table` 컴포넌트에 3가지 중요한 `props`를 전달합니다.
    1.  `columns`: 테이블의 헤더(머리글) 정보를 담은 배열입니다. 각 객체는 `header`(표시될 이름)와 `accessor`(데이터 속성 키) 등을 가집니다.
    2.  `data`: 테이블에 표시될 실제 데이터 배열, 즉 `merchants` 상태입니다.
    3.  `renderRow`: **(핵심)** 각 데이터 행(row)을 어떻게 그릴지 정의하는 함수입니다. `Table` 컴포넌트는 이 함수를 받아 데이터 배열의 각 항목에 대해 실행하여 `<tbody>`를 채웁니다.

### `renderRow` 함수 (페이지 내 정의)

-   **설명**: 별도의 컴포넌트 파일이 아닌, `merchant` 페이지 내에 정의된 함수입니다. `Table` 컴포넌트로부터 `item`(가맹점 데이터 하나)을 인자로 받아, 해당 데이터를 기반으로 완전한 `<tr>` JSX 엘리먼트를 반환합니다.
-   **로직**: 이 함수 덕분에 `Table` 컴포넌트는 데이터의 구체적인 형태를 알 필요가 없어집니다. `renderRow` 함수가 아이콘(`Image`), 가맹점명, 계약 상태(`span` 뱃지), 관리 버튼(`Link`, `FormModal`) 등 `merchant` 데이터에 특화된 모든 렌더링 로직을 담당하기 때문입니다. 이로 인해 `Table`은 어떤 종류의 데이터에도 사용할 수 있는 높은 재사용성을 갖게 됩니다.

### `TableSearch`, `Pagination`, `FormModal` 컴포넌트

-   **`TableSearch`**: 검색창 UI를 제공합니다. (현재는 UI만 존재하며, 실제 검색 기능 연동을 위해서는 상태 관리 로직 추가 필요)
-   **`Pagination`**: 페이지 번호 UI를 제공합니다. (현재는 UI만 존재하며, 페이지 변경에 따른 데이터 재요청 로직 연동 필요)
-   **`FormModal`**: 가맹점 생성(`create`) 또는 삭제(`delete`)와 같은 작업을 위한 모달창을 띄우는 역할을 합니다. `renderRow` 함수 내의 관리 버튼을 통해 호출되며, `type` prop에 따라 다른 작업을 수행합니다.

---

## 4. 데이터 흐름 (Data Flow)

1.  **페이지 로드**: 사용자가 가맹점 관리 페이지에 접근합니다.
2.  **데이터 요청**: `useEffect`가 실행되어 `fetchMerchants` 함수를 호출합니다.
3.  **API 호출**: `/api/merchants`로 GET 요청을 보냅니다.
4.  **상태 업데이트**: API 응답으로 받은 데이터를 가공(`id` 추가)하여 `setMerchants`를 통해 `merchants` 상태를 업데이트합니다.
5.  **리렌더링**: 상태가 변경되었으므로 React가 `MerchantListPage` 컴포넌트를 다시 렌더링합니다.
6.  **Props 전달**: 업데이트된 `merchants` 배열이 `Table` 컴포넌트의 `data` prop으로 전달됩니다.
7.  **테이블 렌더링**: `Table` 컴포넌트는 `data` 배열을 순회하며, 각 `merchant` 객체에 대해 `renderRow` 함수를 호출하여 `<tr>` 엘리먼트들을 생성하고 화면에 최종 테이블을 그립니다.

---

## 5. 요약 및 결론

가맹점 관리 페이지는 **페이지(Container)가 데이터와 상태를 관리하고, 자식 컴포넌트(Presentational)는 데이터를 받아 화면에 그리는 역할에만 집중**하는 효율적인 구조로 설계되었습니다.

-   **페이지**: 데이터 페칭, 상태 관리, 비즈니스 로직 담당.
-   **컴포넌트**: `props`로 받은 데이터를 순수하게 화면에 표시하는 역할 담당.

이러한 설계 덕분에 각 컴포넌트의 역할이 명확해지고, `Table`과 같은 범용 컴포넌트는 다른 페이지에서도 쉽게 재사용할 수 있어 전체 애플리케이션의 개발 효율성과 유지보수성을 크게 향상시킵니다.
